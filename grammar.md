---

copyright:
  years: 2015, 2018
lastupdated: "2018-12-21"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:tip: .tip}
{:important: .important}
{:note: .note}
{:deprecated: .deprecated}
{:pre: .pre}
{:codeblock: .codeblock}
{:screen: .screen}
{:javascript: .ph data-hd-programlang='javascript'}
{:java: .ph data-hd-programlang='java'}
{:python: .ph data-hd-programlang='python'}
{:swift: .ph data-hd-programlang='swift'}

# Using grammars with custom language models
{: #grammars}

The grammar interface is not working at this time due to a known issue. The issue will be fixed and the interface will become functional very early in January 2019.
{: important}

The {{site.data.keyword.speechtotextfull}} service supports the use of grammars with custom language models. You can add grammars to a custom language model and use them for speech recognition. Grammars restrict the set of phrases that the service can recognize from audio.
{: shortdesc}

A grammar uses a formal language specification to define a set of production rules for transcribing strings. The rules specify how to form valid strings from the language's alphabet. When you apply a grammar to speech recognition, the service can return only one or more of the phrases that are generated by the grammar. By limiting the search space for valid strings, the service can deliver results faster and more accurately.

When you use a custom language model and a grammar for speech recognition, the service can return a valid phrase from the grammar or an empty result. If the result is not empty, the service includes a confidence score with the final transcript, as it does for all recognition requests. For grammars, the score indicates the likelihood that the response matched the grammar. False-positives are always possible, especially for simple grammars, so you must always consider the confidence of the service's results when evaluating its response.

The grammars feature is beta functionality. The service supports grammars for all languages for which it supports language model customization.
{: note}

## Supported grammar formats
{: #grammarFormats}

The {{site.data.keyword.speechtotextshort}} service supports grammars that are defined in the following standard formats:

-   *Augmented Backus-Naur Form (ABNF)*, which uses a plain-text representation that is similar to traditional BNF grammar. The media type for this format is `application/srgs`.
-   *XML Form*, which uses XML elements to represent the grammar. The media type for this format is `application/srgs+xml`.

Both grammar formats have the expressive power of a Context-Free Grammar (CFG). However, the service can decode only Type-3 Regular grammars in the Chomsky hierarchy. Such grammars represent finite state automata.

For general information about grammars, see the following Wikipedia pages:

-   [Speech Recognition Grammar Specification ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://en.wikipedia.org/wiki/Speech_Recognition_Grammar_Specification){: new_window}
-   [Augmented Backus-Naur form ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://en.wikipedia.org/wiki/Augmented_Backus%E2%80%93Naur_form){: new_window}
-   [Chomsky hierarchy ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://en.wikipedia.org/wiki/Chomsky_hierarchy){: new_window}

## The Speech Recognition Grammar Specification
{: #grammarSpecification}

The {{site.data.keyword.speechtotextshort}} service supports grammars as defined by the W3C [Speech Recognition Grammar Specification Version 1.0 ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://www.w3.org/TR/speech-grammar/){: new_window}. The specification provides detailed information about the supported formats and about defining a grammar. For information about the supported media types, see [Appendix G. Media Types and File Suffix ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://www.w3.org/TR/speech-grammar/#AppG){: new_window} of the specification.

The service does *not* currently support all features of the Speech Recognition Grammar Specification. Specifically, the service does not support the features described in the following sections of the specification:

-   [Section 1.4 Semantic Interpretation ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://www.w3.org/TR/speech-grammar/#S1.4){: new_window}. {{site.data.keyword.IBM_notm}} is working to support this feature in a future release of the service.
-   [Section 1.5 Embedded Grammars ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://www.w3.org/TR/speech-grammar/#S1.5){: new_window}. {{site.data.keyword.IBM_notm}} is working to support this feature in a future release of the service.
-   [Section 2.2.2 External Reference by URI ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://www.w3.org/TR/speech-grammar/#S2.2.2){: new_window}. The service supports only local references, as described in [Section 2.2.1 Local References ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://www.w3.org/TR/speech-grammar/#S2.2.1){: new_window}. In other words, a grammar must be self-contained.
-   [Section 2.2.3 Special Rules ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://www.w3.org/TR/speech-grammar/#S2.2.3){: new_window}.
-   [Section 2.2.4 Referencing N-gram Documents (Informative) ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://www.w3.org/TR/speech-grammar/#S2.2.4){: new_window}.
-   [Section 2.7 Language ![External link icon](../../icons/launch-glyph.svg "External link icon")](https://www.w3.org/TR/speech-grammar/#S2.7){: new_window}. The service does not support language switching. The service supports only one global language per grammar.

Words in the grammar must be in UTF-8 encoding (ASCII is a subset of UTF-8). Using any other encoding can lead to issues when compiling the grammar or unexpected results in decoding. The service ignores an encoding specified in the header of the grammar.
{: note}
